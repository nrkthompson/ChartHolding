
<!doctype html>
<html style="margin: 0 auto; disaply: block; height: 98%;">

<head>
	<title>Scatter Chart</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
	<style>
	canvas {
		-moz-user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}
	</style>
</head>

<body style="margin: 0 auto; disaply: block; height: 100%;">
	<div style="margin: 0 auto; disaply: block; height: 100%;">
		<canvas id="canvas"></canvas>
	</div>
	<script>
	    var yLabels = {
	      0: 'Country Average', 1: 'Stores and Non-Essential Businesses', 2: 'Schooling and Youth Activities',
	      3: 'Eateries', 4: 'Leisure Activities', 5: 'Contact Services', 6: 'Manufacturing and Construction',
	      7: 'Gatherings', 8: 'Borders and Movement', 9: 'Cultural'
	    }
	    var xLabels = {
	      0: 'Insufficient Data', 1: 'Level 1 (Most Restrictive)', 2: 'Level 2', 3: 'Level 3', 4: 'Level 4', 5: 'Level 5 (Least Restrictive)'
	    }
	    
    
		function generateData(csv, lowerLimit, UpperLimit) {
			d3.text("https://nrkthompson.github.io/ChartHolding/Data/HeatMapMay29.csv", "text/csv", function(text) {
	      			var csv = d3.csv.parseRows(text);
			console.log(csv.toString())
			var data = [];
			for (var i = 0; i < UpperLimit+1; i++) {
				if (i >= lowerLimit && i <= UpperLimit) {
					var preData = csv[i-1];
					console.log(preData.toString())
					var tracker = 1;
					for (i = 1, len = preData.length; i < len; i++) {
						if (tracker == 1) {
							var xValue = parseInt(preData[i], 10);
						} else {
							var yValue = parseInt(preData[i], 10);
							data.push({
								x: xValue,
								y: yValue
							});
							var tracker = tracker * -1
						}
					}
				}
			}
			return data;
			});
		}

		var scatterChartData = {
			datasets: [{
				label: '1-4 Countries',
				pointRadius: 5,
				borderColor: '#D4E6F1',
				backgroundColor: '#D4E6F1',
				data: generateData(csv, 1, 4)
			}, {
				label: '5-8 Countries',
				pointRadius: 5,
				borderColor: '#A9CCE3',
				backgroundColor: '#A9CCE3',
				data: generateData(csv, 5, 8)
			}, {
				label: '9-12 Countries',
				pointRadius: 5,
				borderColor: '#7FB3D5',
				backgroundColor: '#7FB3D5',
				data: generateData(csv, 9, 12)
			}, {
				label: '13-16 Countries',
				pointRadius: 5,
				borderColor: '#5499C7',
				backgroundColor: '#5499C7',
				data: generateData(csv, 13, 16)
			}, {
				label: '17-20 Countries',
				pointRadius: 5,
				borderColor: '#2980B9',
				backgroundColor: '#2980B9',
				data: generateData(csv, 17, 20)
			}, {
				label: '21-24 Countries',
				pointRadius: 5,
				borderColor: '#2471A3',
				backgroundColor: '#2471A3',
				data: generateData(csv, 21, 24)
			}, {
				label: '25-28 Countries',
				pointRadius: 5,
				borderColor: '#1F618D',
				backgroundColor: '#1F618D',
				data: generateData(csv, 25, 28)
			}, {
				label: '29-32 Countries',
				pointRadius: 5,
				borderColor: '#1A5276',
				backgroundColor: '#1A5276',
				data: generateData(csv, 29 ,32)
			}, {
				label: '33-26 Countries',
				pointRadius: 5,
				borderColor: '#154360',
				backgroundColor: '#154360',
				data: generateData(csv, 33 ,36)
			}]
		};

		window.onload = function() {
			var ctx = document.getElementById('canvas').getContext('2d');
			window.myScatter = Chart.Scatter(ctx, {
				data: scatterChartData,
				options: {
					maintainAspectRatio: false,
					tooltips: {
						mode: 'point'
					},
					title: {
						display: true,
						text: 'Level of Reopening by Sector Among OECD Countries and Selected US States'
					},
					scales: {
					      yAxes: [{
						  ticks: {
						      suggestedMin: 0,
						      suggestedMax: 9,
						      stepSize: 1,
						      callback: function(value, index, values) {
							  return yLabels[value];
						      }
						  }
					      }],
					      xAxes: [{
						  ticks: {
						      suggestedMin: 0,
						      suggestedMax: 5,
						      stepSize: 1,
						      callback: function(value, index, values) {
							  return xLabels[value];
						      }
						  }
					      }]
					  }
				}
			});
		};

	</script>
</body>

</html>
